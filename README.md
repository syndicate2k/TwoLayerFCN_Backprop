# Оглавление
1. [Описание проекта](#1-описание-проекта)
2. [Структура проекта](#2-структура-проекта)
3. [Настройка и использование](#3-настройка-и-использование)

# 1. Описание проекта
[[вернуться к оглавлению]](#оглавление)

Этот проект представляет собой реализацию двухслойной полносвязной нейронной сети для классификации рукописных цифр из набора данных MNIST. Проект включает в себя полный цикл работы с моделью: от подготовки данных до обучения, тестирования и предсказания на новых данных.

![image](https://github.com/user-attachments/assets/c85d2d5b-55a1-47e2-a6d8-821823badcc5)


<br><br>


# 2. Структура проекта
[[вернуться к оглавлению]](#оглавление)

Проект имеет следующую структуру:

```plaintext
TwoLayerFCN_Backprop/
│
├── model.py            # Реализация архитектуры нейронной сети
├── train.py            # Скрипт для обучения модели
├── test.py             # Скрипт для тестирования модели
├── predict.py          # Скрипт для предсказания на отдельных изображениях
├── utils.py            # Вспомогательные функции и классы
└── dataset_generator.py # Скрипт для генерации датасета из MNIST
├── requirements.txt         # Зависимости проекта
└── README.md                # Описание проекта
```

<br><br>

# 3. Настройка и использование
[[вернуться к оглавлению]](#оглавление)

### 3.1. Настройка
- **Скачайте содержимое этого репозитория**

  Вы можете либо клонировать этот репозиторий, либо просто скачать его и распаковать в какую-нибудь папку:

 ```bash
  git clone https://github.com/syndicate2k/TwoLayerFCN_Backprop
  cd TwoLayerFCN_Backprop
  ```
- **Установите зависимости**

  Установите необходимые библиотеки с помощью pip:

  ```
  pip install -r requirements.txt
  ```
- **Требования к датасету**

  Датасет должен быть организован в виде директорий, где каждая директория соответствует определенному классу (цифре от 0 до 9).
  
  Пример структуры:
  ```
  dataset/
  ├── train/
  │   ├── 0/
  │   │   ├── image1.png
  │   │   ├── image2.png
  │   │   └── ...
  │   ├── 1/
  │   │   ├── image1.png
  │   │   └── ...
  │   └── ...
  └── test/
      ├── 0/
      │   ├── image1.png
      │   └── ...
      ├── 1/
      │   ├── image1.png
      │   └── ...
      └── ...
  ```

  * Формат: Изображения должны быть в формате PNG или JPG.
  * Размер: Все изображения должны быть размером 28x28 пикселей.
  * Цветовая схема: Изображения должны быть в оттенках серого (одноканальные).
  * Содержимое: Каждое изображение должно содержать рукописную цифру, соответствующую классу директории, в которой оно находится.
  * Метки определяются именами директорий, в которых находятся изображения. Например, все изображения в директории 0 автоматически получают метку 0.
  * Метки должны быть целочисленными значениями от 0 до 9.
### 3.2. Использование
- **Обучение модели / train.py**

  Для обучения модели выполните следующую команду в терминале:

  ```
  python train.py --data_path <path_to_data> --input_size <input_size> --hidden_size <hidden_size> --output_size <output_size> --learning_rate <learning_rate> --epochs <epochs> --weights_path <path_to_weights>
  ```
  Параметры:

  * --data_path: Укажите путь к директории с обучающими данными. Это должен быть путь к папке, содержащей подпапки с изображениями, организованными по классам.
  * --input_size: Размерность входных данных. Для изображений 28x28 пикселей это значение будет 784.
  * --hidden_size: Количество нейронов в скрытом слое. Это число можно изменять в зависимости от сложности задачи.
  * --output_size: Размерность выходного слоя, которая соответствует количеству классов. Для MNIST это значение равно 10.
  * --learning_rate: Скорость обучения. 
  * --epochs: Количество эпох обучения. Чем больше эпох, тем дольше будет обучаться модель, но это может привести к лучшей точности.
  * --weights_path: Путь для сохранения весов модели после обучения.
 
  Пример вывода:
  ```
  Epoch 1, Loss: 0.2301
  Epoch 2, Loss: 0.2257
  ...
  Epoch 100, Loss: 0.0045
  ```

  
- **Тестирование модели / test.py**

  Для тестирования модели выполните следующую команду в терминале:

  ```
   python test.py --data_path <path_to_data> --weights_path <path_to_weights>
  ```
  Параметры:

  * --data_path: Укажите путь к директории с тестовыми данными. Структура должна быть аналогична структуре обучающих данных.
  * --weights_path: Укажите путь к файлу с сохраненными весами модели, который был создан во время обучения.

  Пример вывода:
  ```
  Accuracy: 0.9541
  Precision: 0.9552
  Recall: 0.9507
  F1 Score: 0.9503
  ```

  
- **Генерация датасета / dataset_generator.py**

  Для генерации собственного датасета на основе MNIST выполните следующую команду:

  ```
  python dataset_generator.py --output_dir <output_directory> --num_samples <number_of_samples>
  ```
  Параметры:

  * --output_dir: Укажите директорию, в которую будет сохранен сгенерированный датасет.
  * --num_samples: Укажите количество генерируемых образцов для каждого класса.


- **Предсказание на отдельном изображении / dataset_generator.py**

  Для предсказания класса на отдельном изображении выполните следующую команду:

  ```
  python predict.py --image_path <path_to_image> --weights_path <path_to_weights>
  ```
  Параметры:

  * --image_path: Укажите путь к изображению, которое вы хотите классифицировать.
  * --weights_path: Укажите путь к файлу с сохраненными весами модели.
 
    Пример вывода:
  ```
  Predicted class: 7
  ```
